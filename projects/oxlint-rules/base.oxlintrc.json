{
  "$schema": "../../node_modules/oxlint/configuration_schema.json",
  "plugins": ["typescript", "import", "eslint", "unicorn", "react"],
  "jsPlugins": [
    {
      "name": "react-compiler-js",
      "specifier": "eslint-plugin-react-compiler"
    },
    {
      "name": "react-hooks-js",
      "specifier": "eslint-plugin-react-hooks"
    }
    //   {
    //     "name": "pinyinly",
    //     "specifier": "@pinyinly/eslint-rules"
    //   }
  ],
  "ignorePatterns": ["**/*.d.ts"],
  "categories": {
    "correctness": "error",
    "restriction": "error",
    "pedantic": "error"
  },
  "rules": {
    "complexity": "off",
    "class-methods-use-this": "off",
    "no-bitwise": "off",
    "default-case": "off",
    "no-empty": "off",
    "no-var-requires": "off",
    "no-void": "off",
    // Expo/metro stuff still uses require().
    "no-require-imports": "off",
    "explicit-function-return-type": "off",
    "no-param-reassign": "off",
    "no-undefined": "off",
    "no-plusplus": "off",
    "no-eq-null": "off",
    "no-inline-comments": "off",
    "array-callback-return": "off",
    "no-useless-return": "off",
    "require-await": "off",
    "no-warning-comments": "off",
    "max-depth": "off",
    "max-classes-per-file": "off",
    "eqeqeq": "off",
    "max-lines": "off",
    "max-lines-per-function": "off",
    "curly": "deny",
    "no-console": ["deny", { "allow": ["warn", "error"] }],
    "no-debugger": "deny",
    "no-else-return": "deny",
    "no-useless-rename": "deny",
    "no-const-assign": "deny",
    "no-dupe-class-members": "deny",
    "no-dupe-else-if": "deny",
    "no-dupe-keys": "deny",
    "no-duplicate-case": "deny",
    "no-eval": "deny",
    "no-func-assign": "deny",
    "no-global-assign": "deny",
    "no-fallthrough": [
      "error",
      { "commentPattern": ".*intentional fallthrough.*" }
    ],

    "unicorn/no-thenable": "deny",
    "unicorn/no-empty-file": "deny",
    "unicorn/no-await-in-promise-methods": "deny",
    "unicorn/numeric-separators-style": [
      "error",
      {
        "onlyIfContainsSeparator": true,
        "number": { "onlyIfContainsSeparator": false }
      }
    ],
    "unicorn/no-null": "off", // null used extensively
    "unicorn/number-literal-case": "off", // overwritten by prettier
    "unicorn/prefer-module": "off", // still need to use require(…) with metro
    "unicorn/prevent-abbreviations": "off", // abbreviations are fine
    "unicorn/no-nested-ternary": "off", // nested ternaries are not so bad
    "unicorn/filename-case": "off", // using camelCase for filenames
    "unicorn/prefer-string-starts-ends-with": "error",
    "unicorn/no-array-callback-reference": "off",
    "unicorn/prefer-math-trunc": "off",

    "eslint/prefer-const": "deny",
    "eslint/no-unused-expressions": "deny",
    "eslint/no-restricted-imports": [
      "deny",
      {
        "paths": [
          {
            "name": "react-native",
            "importNames": ["SafeAreaView"],
            "message": "Please use \"useSafeAreaInsets\" from \"react-native-safe-area-context\" instead."
          },
          {
            "name": "react",
            "importNames": ["forwardRef", "memo", "useContext"],
            "message": "Migrate to React 19 patterns."
          },
          {
            "name": "vitest",
            "importNames": ["it"],
            "message": "Use \"test(…)\" instead of \"it(…)\" for consistency."
          },
          {
            "name": "hanzi",
            "message": "Please use @/dictionary/hanzi instead."
          },
          {
            "name": "nanoid",
            "message": "Please use @/util/nanoid instead."
          },
          {
            "name": "date-fns",
            "message": "Please use date-fns/* instead for smaller bundle size.",
            "allowTypeImports": true
          },
          {
            "name": "lodash",
            "message": "Please use lodash/* instead for smaller bundle size."
          },
          {
            "name": "node:assert",
            "message": "Please use vitest instead."
          },
          {
            "name": "node:assert/strict",
            "message": "Please use vitest instead."
          },
          {
            "name": "node:test",
            "message": "Please use vitest instead."
          },
          {
            "name": "zod",
            "message": "Please use zod/v4 instead."
          },
          {
            "name": "glob",
            "message": "Please use glob from @pinyinly/lib/fs instead."
          },
          {
            "name": "node:fs/promises",
            "message": "Please use @pinyinly/lib/fs instead."
          },
          {
            "name": "node:fs",
            "message": "Please use @pinyinly/lib/fs instead."
          },
          {
            "name": "@bacons/mdx",
            "message": "Please use @/client/mdx instead."
          }
        ]
      }
    ],

    "import/unambiguous": "off",
    "import/max-dependencies": "off",
    // disallow non-import statements appearing before import statements
    "import/first": "deny",
    // disallow AMD require/define
    "import/no-amd": "deny",
    // forbid default exports - we want to standardize on named exports so that imported names are consistent
    "import/no-default-export": "deny",
    // disallow imports from duplicate paths
    "import/no-duplicates": "deny",
    // Forbid mutable exports
    "import/no-mutable-exports": "deny",
    // Forbid a module from importing itself
    "import/no-self-import": "deny",
    // Forbid import of modules using absolute paths
    "import/no-absolute-path": "error",
    // enforces consistent type specifier style for named imports
    "import/consistent-type-specifier-style": "error",

    "typescript/prefer-for-of": "deny",
    "typescript/no-dynamic-delete": "deny",
    "typescript/no-implied-eval": "deny",
    "typescript/no-unnecessary-type-assertion": "deny",
    "typescript/no-unsafe-assignment": "deny",
    "typescript/no-unsafe-member-access": "deny",
    "typescript/no-unsafe-argument": "deny",
    "typescript/no-explicit-any": "deny",
    "typescript/no-import-type-side-effects": "deny",
    "typescript/consistent-type-imports": "deny",
    "typescript/no-unsafe-return": "deny",
    "typescript/no-unsafe-call": "deny",
    "typescript/no-unnecessary-type-constraint": "deny",
    "typescript/require-await": "off",
    "typescript/explicit-module-boundary-types": "off",
    // Often only having one usage of a type parameter is fine because it's
    // the only way to use "_ extends _".
    "typescript/no-unnecessary-type-arguments": "deny",
    "typescript/return-await": "deny",
    "typescript/no-empty-object-type": "deny",
    "typescript/strict-boolean-expressions": "deny",
    "typescript/switch-exhaustiveness-check": [
      "deny",
      { "requireDefaultForNonUnion": true }
    ],
    "typescript/restrict-template-expressions": [
      "deny",
      {
        "allowAny": false,
        "allowArray": false,
        "allowBoolean": true,
        "allowNever": false,
        "allowNullish": false,
        "allowNumber": true,
        "allowRegExp": false
      }
    ],
    "typescript/promise-function-async": [
      "error",
      { "allowedPromiseNames": ["ReactNode"] }
    ],

    "react/exhaustive-deps": "off",
    "react/jsx-filename-extension": ["error", { "extensions": ["tsx"] }],
    "react/no-children-prop": "error",
    "react/no-multi-comp": "off",
    "react/only-export-components": "error",

    "react-hooks-js/exhaustive-deps": "error",
    //
    // From https://github.com/TheAlexLichter/oxlint-react-compiler-rules/issues/1#issue-3904052296
    "react-hooks-js/component-hook-factories": "error",
    "react-hooks-js/config": "error",
    "react-hooks-js/error-boundaries": "error",
    "react-hooks-js/gating": "error",
    "react-hooks-js/globals": "error",
    "react-hooks-js/immutability": "error",
    "react-hooks-js/incompatible-library": "error",
    "react-hooks-js/preserve-manual-memoization": "error",
    "react-hooks-js/purity": "error",
    "react-hooks-js/refs": "error",
    "react-hooks-js/set-state-in-effect": "error",
    "react-hooks-js/set-state-in-render": "error",
    "react-hooks-js/static-components": "error",
    "react-hooks-js/unsupported-syntax": "error",
    "react-hooks-js/use-memo": "error",
    //
    // Recommended-latest rules (from LintRulePreset.RecommendedLatest)
    "react-hooks-js/void-use-memo": "error",
    //
    // Off rules (LintRulePreset.Off) - not enabled by default
    "react-hooks-js/automatic-effect-dependencies": "error",
    "react-hooks-js/capitalized-calls": "error",
    "react-hooks-js/fbt": "error",
    "react-hooks-js/fire": "error",
    "react-hooks-js/hooks": "error",
    "react-hooks-js/invariant": "error",
    "react-hooks-js/memoized-effect-dependencies": "error",
    // "react-hooks-js/no-deriving-state-in-effects": "error",
    "react-hooks-js/rule-suppression": "error",
    "react-hooks-js/syntax": "error",
    // "react-hooks-js/todo": "error",

    "react-compiler-js/react-compiler": "error"

    //
    // pinyinly
    //

    // "pinyinly/import-names": [
    //   "error",
    //   {
    //     "defaultImports": {
    //       "node:path": "path",
    //       "react-native-reanimated": "Reanimated"
    //     },
    //     "namedImports": {
    //       "posthog-react-native": {
    //         "PostHogProvider": "RnPostHogProvider",
    //         "usePostHog": "rnUsePostHog"
    //       },
    //       "posthog-js/react": {
    //         "PostHogProvider": "WebPostHogProvider",
    //         "usePostHog": "webUsePostHog"
    //       },
    //       "react": {
    //         "Suspense": "ReactSuspense"
    //       },
    //       "react-native": {
    //         "Animated": "RnAnimated",
    //         "Easing": "RnEasing",
    //         "Image": "RnImage"
    //       }
    //     }
    //   }
    // ],
    // "pinyinly/nameof": "error",
    // "pinyinly/glob-template": "error"
  },
  "overrides": [
    // Ban CommonJS globals in ESM files, use import.meta.* instead
    {
      "files": ["**/*.{js,mjs,ts,tsx}"],
      "rules": {
        "no-restricted-globals": ["error", "__dirname", "__filename"]
      }
    },
    // Bin scripts
    {
      "files": ["bin/**/*.{js,mjs,ts,tsx}"],
      "rules": {
        "no-console": "off"
      }
    },
    {
      "files": ["**/*.cjs", "tailwind.config.js"],
      "rules": {
        "import/no-commonjs": "off"
      }
    },
    // Config files often export their config as default.
    {
      "files": ["*.config.*"],
      "rules": {
        "import/no-default-export": "off"
      }
    },
    {
      "files": ["test/**"],
      "rules": {
        // it's nice to be able to write a quick generator functions in a test without worrying about yield
        "require-yield": "off",
        "no-non-null-assertion": "off",

        "eslint/require-yield": "off",
        "eslint/no-empty-function": "off",
        "eslint/no-empty-pattern": "off",
        "eslint/no-inner-declarations": "off",

        "import/no-relative-parent-imports": "off",

        "typescript/no-dynamic-delete": "off",
        "typescript/no-explicit-any": "off",
        "typescript/restrict-template-expressions": "off",

        "react/rules-of-hooks": "off"
        // Backup from eslint config:
        //
        // "typescript/no-non-null-assertion": "off",
        // "typescript/no-unsafe-assignment": "off",
        // "typescript/require-await": "off", // this is annoying when you want a little function to return a promise
        // "typescript/return-await": "off", // this is annoying when you want a little function to return a promise
        // // It's useful to use inline type annotations for mocking.
        // "unicorn/consistent-function-scoping": "off", // it's useful to write functions in the scope of a test
        // "unicorn/no-useless-undefined": "off" // writing undefined can be useful when writing mocks
      }
    }
  ]
}
